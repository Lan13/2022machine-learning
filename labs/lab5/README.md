# 机器学习 LAB5

Comprehensive Experiment

By Benwei Wu 2022.12.24

## 1. 实验原理

可参考本课程涉及的所有分类模型以及原理

## 2. Data

在`train_feature.csv文件中，有10000条120维特征数据`，

在`train_label.csv文件中`，有`10000条1维标签数据`

在`test_feature.csv`文件中，有`3000`条`120`维特征数据

## 3. 任务、提示以及要求

### 3.1 任务

- **数据预处理**。需要注意，提供数据包含大量冗余随机特征、outlier数据以及Null数据，你需要综合运用所学的知识进行数据降维、降噪、补缺、特征提取、编码以及必要的其他数据预处理工作。
- **数据划分**。你需要将所提供的`train`数据集按照所学的方法拆分成训练集以及测试集。
- **模型训练**。你需要分别使用本课程所学习的线性回归模型、决策树模型、神经网络模型、支持向量机以及XGBoost等分类模型来完成标签预测任务。
- **模型验证**。你需要将`test_feature.csv`的数据输入到一个你认为性能最佳的模型中，然后仿照`train_label.csv`的文件格式生成对应标签数据文件，命名为`test_label.csv`，并将它包含在你所提交的压缩包中。
- **实验分析**。你需要仔细撰写实验报告以及相关分析。

### 3.2 评价指标

- 你可以在实验中使用下列指标来验证你的算法效果以及不同参数对于结果的影响

  - $E(f;D)=\frac{1}{m}\sum_{i=1}^m\mathbb{I}(f(x_i)\neq y_i)$，分类错误率，越小越好
  - $Acc(f;D)=1-E(f;D)$，分类精度，越大越好
  - 运行时间
- 你也可以选取你认为合理的评价指标，评价指标的选取不会影响最终的实验分数。
- 但需要注意，在**模型验证**环节，我们将使用$Acc(f;D)$指标对你的生成结果进行判分。当然，这个分数只是最终实验分数的组成，并不唯一，因此我们鼓励你使用更多指标来综合评价模型性能。

### 3.2 提示

- 原则上你可以直接使用之前在`lab1-lab4`中你自己独立编写的程序，但如果部分算法（如神经网络模型）之前你未写过，你可以调用一些已有的算法库。算法复现并不是我们的考察重点，我们更加希望看到的是你整体实验的完整性以及严谨性，是否包括特征预处理、模型评估、调参、模型选择、假设检验等一整套完备流程，我们也将主要基于此对你的实验报告进行判分。

- 你可以调用sklearn库中的MLPClassifier来实现神经网络模型，例如

  ```python
  from sklearn.neural_network import MLPClassifier
  ```

  但我们希望你在调库前能认真阅读官方文档（https://scikit-learn.org/stable/modules/generated/sklearn.neural_network.MLPClassifier.html#sklearn.neural_network.MLPClassifier），理解不同参数的实际含义将有利于你的模型调参。

- 除了本课程所包含的基础模型外，我们鼓励你增加课程外所学习的最新模型。当然你仅需完成基本任务，即可拿到相应的实验分数。

- 不要简单地堆砌实验数据以及程序代码，我们希望看到的是严谨的实验分析。

### 3.3 要求

- 你可以和其他同学讨论，但是你不可以剽窃代码，我们会用自动系统来确定你的程序的相似性，一旦被发现，你们两个都会得到这个项目的零分。
- 请务必确保`test_label.csv`文件数据格式与`train_label.csv`相同，否则可能无法判分。

## 4. 提交

* 报告推荐格式

  1. 实验目的（可选）
  2. 实验原理（若不重要可以简要说明）
  3. 实验步骤（从读取数据、模型训练、使用xx的参数，xx的模型，得到了多少组的结果，总之就是你在每块代码做了什么事情）
  4. 实验结果（对输出进行总结、比较、可视化）
  5. 实验分析（分析结果出现的原因、分析原因）

* 提交 .zip 文件，包含以下内容（请直接对这三个文件打包）

  --main.ipynb

  --test_label.csv

  --Report.pdf

* 请命名你的文件为 `LAB5_PBXXXXXXXX_中文名.zip`, 例如 `LAB5_PB19061297_XXX`, **对于错误命名的文件，我们将不会计算分数，请注意，我们会严格执行这方面的规定**

* 请发邮件至 [ml_2022_fall@163.com](mailto:ml_2022_fall@163.com) 附带您的文件，在截止日期之前

* **截止日期: 2023.01.20 23:59:59** 



# LAB5 讲解

### 实验目的

考察完整进行实验的能力。此处“实验”的含义是指整个任务的过程，不单单指模型的构建。

一般来说，我们整个分类任务可以分为以下部分，供你参考：

1. 获取数据集，对数据进行分析

> 数据集我们已经给出，对于数据的部分特征我们已经给出，你也可以针对你发现的其他特点进行说明和处理。

2. 对数据进行处理，形成测试集和测试集

> 针对你发现的问题，选择合适的处理方式，推荐使用搜索引擎和课程内容 Chap. 2 & 11。

3. 对于任务，选择合适的模型

> 每个模型实际上包含多种对于不同任务的处理方式，关键的是算法的核心。
>
> 例如，在决策树中，实际上存在分类树和回归树两种，你应该选择更合适的方法

4. 利用训练集训练模型，调整超参数以达到在测试集上达到更好的效果，保存模型

> 请注意各个模型有哪些超参数是可以调整的，体现你是通过对比后选出更好的模型。
>
> 注意，调整参数不应该是一个做样子的过程，需要达到“充分”调参。
>
> 如果数量太多可以以图的形式表示。
>
> 尽管我们不需要同学提交模型，但是希望大家学会、养成保存模型的良好习惯。

5. 注意你的评价指标是否合适，同时进行假设检验。

> 参考 Chap 2.

6. 可视化你的结果
7. 挑选一个最好的模型，用其对 test_label 进行预测，提交你的 pred.

> 只需要提交你认为表现最好的模型的预测结果。

1. 对于数据的处理、数据集的划分、模型的验证等内容可以使用已有的库函数，调用的函数一定是要有具体的、有针对性的功能，而不是一个“万能函数”
2. 实验结果正确命名后，与实验报告、代码压缩后提交
3. 调参可以手动调，也可以自动调参数
4. 由于 lab3 我们写的是回归树和回归树为基分类器的 xgboost，我们对于决策树和 xgbclassifier 也可以调包。神经网络也可以调包。具体reference 为：
   1. https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html#sklearn.tree.DecisionTreeClassifier
   2. https://xgboost.readthedocs.io/en/stable/python/python_api.html#xgboost.XGBClassifier
   3. https://scikit-learn.org/stable/modules/generated/sklearn.neural_network.MLPClassifier.html#sklearn.neural_network.MLPClassifier

主题: 顾言午(YanwuGu)的快速会议
日期: 2022-12-24 19:49:37
录制文件：https://meeting.tencent.com/v2/cloud-record/share?id=7fca8550-295d-446a-bf1c-0efc3e52c00a&from=3
